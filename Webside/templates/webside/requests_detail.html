{% extends 'webside/base.html' %}

{% block content %}
<a class="btn btn-default" href="{% url 'requests' %}" style="margin-left:-100px;"><i class="large material-icons">navigate_before</i>
</a>
<div class="card" style="max-width: 800px; margin:auto">
    <div class="center-align">
      <div class="card grey lighten-4">
        <div class="card-content teal-text">
          <div class="post">
            <h2>{{ post.title }}</h2>
            <p>{{ post.text|linebreaksbr }}</p>
            <div class="black-text">
            <p>{{ post.community }}</p>
            </div>
            <a class="modal-trigger" style="margin:auto" href="#profileView"><p>{{ post.author }}</p></a>

            <!-- Modal Structure  overview profile post-->
            <div id="profileView" class="modal">
              <div class="modal-content">
              <h4>{{ post.author }}</h4>
                <p>Rating: 4</p>
                <p>Karma: gitt 14, fått 12</p>
                <p>Sum: 86</p>
              </div>
              <div class="modal-footer">
                {% ifnotequal post.author.username user.username %}
                  <a href="#reportPost" class="modal-trigger modal-close waves-effect waves-red btn-flat">Rapportér bruker</a>
                {% endifnotequal %}
                <a href="#!" class="modal-close waves-effect waves-red btn-flat">Lukk</a>
              </div>
            </div>

            <!-- Modal Structure reason for report-->
            <div id="reportPost" class="modal">
              <form method="POST" class="post-form">
              <div class="modal-content">
                <h5> Begrunnelse for rapportering av {{ post.author }} </h5>
                  {% csrf_token %}
                  {{ form.as_p }}
              </div>
              <div class="modal-footer">
                <button type = "submit" href="{% url 'requests_detail' pk=post.pk %}" class="modal-close waves-effect waves-green btn-flat" name="report_post">Send</button>
              </div>
              </form>
            </div>

              {% if post.published_date %}
                <div class="date black-text">
                  {{ post.published_date }}
                </div>
                {% endif %}
            </div>
            </div>
          </div>
          </div>
          </div>
          <div class="center-align">
            <a class="btn btn-default" style="margin:auto" href="{% url 'add_comment_to_post' pk=post.pk %}">Legg igjen en kommentar</a>
            <br><br>
            {% for comment in post.comments.all %}
            <div class="divider"></div>
            <div class="section">
            <div class="comment">
            <a class="modal-trigger" style="margin:auto" href="#profileViewComment"><strong>{{ comment.author }}</strong></a>

            <!-- Modal Structure rating/finish trade-->
            <div id="ratingModal" class="modal">
              <div class="modal-content">
                <p>Gi rating til {{ comment.author }}:</p>
                <section class='rating-widget'>

                  <!-- Rating Stars Box -->
                    <div class='row center'>
                      <ul class="center-align valgin" id='stars'>
                        <div class="col offset-s2">
                          <li class='star' title='Poor' data-value='1'>
                            <a onclick="give1Star()" class="btn-floating btn-large waves-effect waves-light yellow"><i class="material-icons">star</i></a>
                          </li>
                        </div>
                        <div class="col">
                          <li class='star' title='Fair' data-value='2'>
                            <a onclick="give2Star()" class="btn-floating btn-large waves-effect waves-light yellow"><i class="material-icons">star</i></a>
                          </li>
                        </div>
                        <div class="col">
                          <li class='star' title='Good' data-value='3'>
                            <a onclick="give3Star()" class="btn-floating btn-large waves-effect waves-light yellow"><i class="material-icons">star</i></a>
                          </li>
                        </div>
                        <div class="col">
                          <li class='star' title='Excellent' data-value='4'>
                            <a onclick="give4Star()" class="btn-floating btn-large waves-effect waves-light yellow"><i class="material-icons">star</i></a>
                          </li>
                        </div>
                        <div class="col">
                          <li class='star' title='WOW!!!' data-value='5'>
                            <a onclick="give5Star()" class="btn-floating btn-large waves-effect waves-light yellow"><i class="material-icons">star</i></a>
                          </li>
                        </div>
                      </ul>
                  </div>
                </section>
              </div>
              <form method="GET" class="get-class">
              <p id="demo">Du kan gi fra 1 til 5 stjerner</p>
              <div class="modal-footer">
                <button type="submit" href="{% url 'requests_detail' pk=post.pk %}" class="modal-close waves-effect waves-green btn-flat" name="finish">Send</button>
              </div>
              </form>
            </div>

            <!-- Modal Structure overview profile comment-->
            <div id="profileViewComment" class="modal">
              <div class="modal-content">
              <h4>{{ comment.author }}</h4>
                <p>Rating: 4</p>
                <p>Karma: gitt 14, fått 12</p>
                <p>Sum: 86</p>
              </div>
              <div class="modal-footer">
                {% if post.author.username == user.username %}
                  {% ifnotequal comment.author.username user.username %}
                  <a href="#ratingModal" class="modal-trigger modal-close waves-effect waves-green btn-flat">Fullfør handel</a>
                  {% endifnotequal %}
                {% endif %}
                {% ifnotequal comment.author.username user.username %}
                <a href="#reportComment" class="modal-trigger modal-close waves-effect waves-red btn-flat">Rapportér bruker</a>
                {% endifnotequal %}
                <a href="#!" class="modal-close waves-effect waves-red btn-flat">Lukk</a>
              </div>
            </div>

            <!-- Modal Structure report-->
            <div id="reportComment" class="modal">
              <form method="POST" class="post-form">
              <div class="modal-content">
                <h5> Begrunnelse for rapportering av {{ comment.author }} </h5>
                  {% csrf_token %}
                  {{ form.as_p }}
              </div>
              <div class="modal-footer">
                <button type = "submit" href="{% url 'requests_detail' pk=post.pk %}" class="modal-close waves-effect waves-green btn-flat" name="report_comment">Send</button>
              </div>
              </form>
            </div>

            <p>{{ comment.text|linebreaks }}</p>
            <div class="date">{{ comment.created_date }}</div>
            </div>
            {% empty %}
            <p>Ingen kommentarer enda :(</p>
            {% endfor %}
            </div>
            </div>
            <div>

          {% if post.author.username == user.username %}
          <a class="btn-floating btn-large waves-effect waves-light red" href="{% url 'request_delete' pk=post.pk %}" style="position:fixed; left:90%; top:90%;"><i class="material-icons"</i>delete</a>
          {% endif %}
              </div>
{% endblock %}
